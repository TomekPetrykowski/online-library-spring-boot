<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{fragments/layout :: header(${book.id != null ? 'Edytuj książkę' : 'Dodaj książkę'})}"></head>
  <body>
    <nav th:replace="~{fragments/layout :: navbar}"></nav>

    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card">
            <div class="card-header bg-primary text-white">
              <h5 class="mb-0">
                <i class="bi bi-book"></i>
                <span th:text="${book.id != null ? 'Edytuj książkę' : 'Dodaj nową książkę'}"></span>
              </h5>
            </div>
            <div class="card-body">
              <form
                th:action="${book.id != null ? '/admin/books/' + book.id : '/admin/books'}"
                th:object="${book}"
                method="post">
                <div class="mb-3">
                  <label for="title" class="form-label">Tytuł *</label>
                  <input
                    type="text"
                    class="form-control"
                    id="title"
                    th:field="*{title}"
                    th:classappend="${#fields.hasErrors('title') ? 'is-invalid' : ''}" />
                  <div class="invalid-feedback" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></div>
                </div>

                <div class="mb-3">
                  <label for="description" class="form-label">Opis</label>
                  <textarea class="form-control" id="description" th:field="*{description}" rows="4"></textarea>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="isbn" class="form-label">ISBN *</label>
                    <input
                      type="text"
                      class="form-control"
                      id="isbn"
                      th:field="*{isbn}"
                      th:classappend="${#fields.hasErrors('isbn') ? 'is-invalid' : ''}" />
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('isbn')}" th:errors="*{isbn}"></div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="publishYear" class="form-label">Rok wydania *</label>
                    <input
                      type="number"
                      class="form-control"
                      id="publishYear"
                      th:field="*{publishYear}"
                      th:classappend="${#fields.hasErrors('publishYear') ? 'is-invalid' : ''}" />
                    <div
                      class="invalid-feedback"
                      th:if="${#fields.hasErrors('publishYear')}"
                      th:errors="*{publishYear}"></div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="publisher" class="form-label">Wydawnictwo</label>
                    <input type="text" class="form-control" id="publisher" th:field="*{publisher}" />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="copiesAvailable" class="form-label">Dostępne kopie</label>
                    <input
                      type="number"
                      class="form-control"
                      id="copiesAvailable"
                      th:field="*{copiesAvailable}"
                      min="0" />
                  </div>
                </div>

                <div class="mb-3">
                  <label for="coverImagePath" class="form-label">Ścieżka okładki</label>
                  <input
                    type="text"
                    class="form-control"
                    id="coverImagePath"
                    th:field="*{coverImagePath}"
                    placeholder="/uploads/covers/nazwa-pliku.jpg" />
                </div>

                <div class="mb-3">
                  <label class="form-label">Autorzy</label>
                  <select class="form-select" name="authorIds" multiple size="5">
                    <option
                      th:each="author : ${allAuthors}"
                      th:value="${author.id}"
                      th:text="${author.name + ' ' + author.lastName}"
                      th:selected="${book.authors != null && book.authors.contains(author)}">
                    </option>
                  </select>
                  <small class="text-muted">Przytrzymaj Ctrl aby wybrać wielu autorów</small>
                </div>

                <div class="mb-3">
                  <label class="form-label">Gatunki</label>
                  <select class="form-select" name="genreIds" multiple size="5">
                    <option
                      th:each="genre : ${allGenres}"
                      th:value="${genre.id}"
                      th:text="${genre.name}"
                      th:selected="${book.genres != null && book.genres.contains(genre)}">
                    </option>
                  </select>
                  <small class="text-muted">Przytrzymaj Ctrl aby wybrać wiele gatunków</small>
                </div>

                <div class="d-flex justify-content-between">
                  <a th:href="@{/admin/books}" class="btn btn-secondary"> <i class="bi bi-arrow-left"></i> Anuluj </a>
                  <button type="submit" class="btn btn-primary"> <i class="bi bi-check-lg"></i> Zapisz </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer th:replace="~{fragments/layout :: footer}"></footer>
  </body>
</html>
